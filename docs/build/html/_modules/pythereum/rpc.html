
<!DOCTYPE html>

<html lang="python">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pythereum.rpc &#8212; Pythereum 1.1.6 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for pythereum.rpc</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">asynccontextmanager</span>

<span class="kn">from</span> <span class="nn">aiohttp</span> <span class="kn">import</span> <span class="n">ClientSession</span>
<span class="kn">import</span> <span class="nn">websockets</span>
<span class="kn">from</span> <span class="nn">pythereum.exceptions</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ERPCRequestException</span><span class="p">,</span>
    <span class="n">ERPCInvalidReturnException</span><span class="p">,</span>
    <span class="n">ERPCSubscriptionException</span><span class="p">,</span>
    <span class="n">ERPCManagerException</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">pythereum.common</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">HexStr</span><span class="p">,</span>
    <span class="n">EthDenomination</span><span class="p">,</span>
    <span class="n">BlockTag</span><span class="p">,</span>
    <span class="n">DefaultBlock</span><span class="p">,</span>
    <span class="n">SubscriptionType</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>
<span class="kn">from</span> <span class="nn">pythereum.socket_pool</span> <span class="kn">import</span> <span class="n">WebsocketPool</span>
<span class="kn">from</span> <span class="nn">pythereum.dclasses</span> <span class="kn">import</span> <span class="n">Block</span><span class="p">,</span> <span class="n">Sync</span><span class="p">,</span> <span class="n">Receipt</span><span class="p">,</span> <span class="n">Log</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">,</span> <span class="n">TransactionFull</span>


<div class="viewcode-block" id="convert_eth"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.convert_eth">[docs]</a><span class="k">def</span> <span class="nf">convert_eth</span><span class="p">(</span>
    <span class="n">quantity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span><span class="p">,</span>
    <span class="n">convert_from</span><span class="p">:</span> <span class="n">EthDenomination</span><span class="p">,</span>
    <span class="n">covert_to</span><span class="p">:</span> <span class="n">EthDenomination</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts eth values from a given denomination to another.</span>
<span class="sd">    Strings passed in are automatically decoded from hexadecimal to integers, as are Hex values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">quantity</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">quantity</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">quantity</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">quantity</span><span class="p">,</span> <span class="n">HexStr</span><span class="p">):</span>
        <span class="n">quantity</span> <span class="o">=</span> <span class="n">quantity</span><span class="o">.</span><span class="n">integer_value</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">convert_from</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">quantity</span><span class="p">)</span> <span class="o">/</span> <span class="n">covert_to</span><span class="o">.</span><span class="n">value</span></div>


<div class="viewcode-block" id="parse_results"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.parse_results">[docs]</a><span class="k">def</span> <span class="nf">parse_results</span><span class="p">(</span>
    <span class="n">res</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">is_subscription</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">builder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validates and parses the results of an RPC</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">parse_results</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">res</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">is_subscription</span> <span class="ow">and</span> <span class="s2">&quot;params&quot;</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
        <span class="c1"># Subscription results are returned in a different format to normal calls</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="s2">&quot;result&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
        <span class="c1"># Error case as no result is found</span>
        <span class="k">if</span> <span class="s2">&quot;error&quot;</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">][</span><span class="s2">&quot;message&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span>
                <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">builder</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot; for builder </span><span class="si">{</span><span class="n">builder</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">ERPCRequestException</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">][</span><span class="s2">&quot;code&quot;</span><span class="p">],</span> <span class="n">errmsg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ERPCInvalidReturnException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid return value from RPC, return format: </span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span></div>


<div class="viewcode-block" id="Subscription"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.Subscription">[docs]</a><span class="k">class</span> <span class="nc">Subscription</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A representation of a subscription to receive information from an ethereum endpoint</span>
<span class="sd">    Information is automatically decoded into an appropriate format upon being retrieved from the endpoint</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">subscription_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">socket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span><span class="p">,</span>
        <span class="n">subscription_type</span><span class="p">:</span> <span class="n">SubscriptionType</span> <span class="o">=</span> <span class="n">SubscriptionType</span><span class="o">.</span><span class="n">new_heads</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subscription_id</span> <span class="o">=</span> <span class="n">subscription_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">socket</span> <span class="o">=</span> <span class="n">socket</span>

        <span class="c1"># Selects the appropriate function to interpret the output of self.recv</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decode_function</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">SubscriptionType</span><span class="o">.</span><span class="n">new_heads</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_heads_decoder</span><span class="p">,</span>
            <span class="n">SubscriptionType</span><span class="o">.</span><span class="n">logs</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">logs_decoder</span><span class="p">,</span>
            <span class="n">SubscriptionType</span><span class="o">.</span><span class="n">new_pending_transactions</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_pending_transactions_decoder</span><span class="p">,</span>
            <span class="n">SubscriptionType</span><span class="o">.</span><span class="n">syncing</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">syncing_decoder</span><span class="p">,</span>
        <span class="p">}[</span><span class="n">subscription_type</span><span class="p">]</span>

<div class="viewcode-block" id="Subscription.recv"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.Subscription.recv">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">recv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Block</span> <span class="o">|</span> <span class="n">Log</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="n">Sync</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        infinite async generator function which will yield new information retrieved from a websocket</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">parse_results</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">is_subscription</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode_function</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></div>

<div class="viewcode-block" id="Subscription.new_heads_decoder"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.Subscription.new_heads_decoder">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">new_heads_decoder</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Block</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Block</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="Subscription.logs_decoder"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.Subscription.logs_decoder">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">logs_decoder</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Log</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="Subscription.new_pending_transactions_decoder"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.Subscription.new_pending_transactions_decoder">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">new_pending_transactions_decoder</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HexStr</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HexStr</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="Subscription.syncing_decoder"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.Subscription.syncing_decoder">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">syncing_decoder</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sync</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Sync</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="NonceManager"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.NonceManager">[docs]</a><span class="k">class</span> <span class="nc">NonceManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Manages the nonces of addresses for the purposes of constructing transactions,</span>
<span class="sd">    requires an RPC connection in order to get starting transaction counts for each address.</span>

<span class="sd">    This currently operates assuming no other sources are creating transactions from a given address.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rpc</span><span class="p">:</span> <span class="s2">&quot;EthRPC | str | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rpc</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">rpc</span> <span class="o">=</span> <span class="n">EthRPC</span><span class="p">(</span><span class="n">rpc</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rpc</span> <span class="o">=</span> <span class="n">rpc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonces</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_close_pool</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nonces</span><span class="p">[</span><span class="n">HexStr</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nonces</span><span class="p">[</span><span class="n">HexStr</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__aenter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc</span><span class="o">.</span><span class="n">pool_connected</span><span class="p">():</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc</span><span class="o">.</span><span class="n">start_pool</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_close_pool</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ERPCManagerException</span><span class="p">(</span>
                <span class="s2">&quot;NonceManager was never given EthRPC or RPC Url instance&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__aexit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_close_pool</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc</span><span class="o">.</span><span class="n">close_pool</span><span class="p">()</span>

<div class="viewcode-block" id="NonceManager.next_nonce"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.NonceManager.next_nonce">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">next_nonce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">address</span> <span class="o">=</span> <span class="n">HexStr</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">address</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nonces</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nonces</span><span class="p">[</span><span class="n">address</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpc</span><span class="o">.</span><span class="n">get_transaction_count</span><span class="p">(</span>
                <span class="n">address</span><span class="p">,</span> <span class="n">BlockTag</span><span class="o">.</span><span class="n">latest</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nonces</span><span class="p">[</span><span class="n">address</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nonces</span><span class="p">[</span><span class="n">address</span><span class="p">]</span></div>

<div class="viewcode-block" id="NonceManager.fill_transaction"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.NonceManager.fill_transaction">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fill_transaction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">tx</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">Transaction</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">Transaction</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function mutates input transaction dictionaries such that they are filled with the correct nonce values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">sub_tx</span> <span class="ow">in</span> <span class="n">tx</span><span class="p">:</span>
                <span class="c1"># If elements in a list are references to the same list this will not work properly</span>
                <span class="n">sub_tx</span><span class="p">[</span><span class="s2">&quot;nonce&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HexStr</span><span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_nonce</span><span class="p">(</span><span class="n">sub_tx</span><span class="p">[</span><span class="s2">&quot;from&quot;</span><span class="p">]))</span>
        <span class="k">elif</span> <span class="n">tx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tx</span><span class="p">[</span><span class="s2">&quot;nonce&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HexStr</span><span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_nonce</span><span class="p">(</span><span class="n">tx</span><span class="p">[</span><span class="s2">&quot;from&quot;</span><span class="p">]))</span></div></div>


<div class="viewcode-block" id="EthRPC"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC">[docs]</a><span class="k">class</span> <span class="nc">EthRPC</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class managing communication with an Ethereum node via the Ethereum JSON RPC API.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">pool_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">use_socket_pool</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param url: URL for the ethereum node to connect to</span>
<span class="sd">        :param pool_size: The number of websocket connections opened for the WebsocketPool</span>
<span class="sd">        :param use_socket_pool: Whether the socket pool should be used or AIOHTTP requests</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_id</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">use_socket_pool</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span> <span class="o">=</span> <span class="n">WebsocketPool</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">pool_size</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">ClientSession</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_http_url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;wss://&quot;</span><span class="p">,</span> <span class="s2">&quot;https://&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;ws://&quot;</span><span class="p">,</span> <span class="s2">&quot;http://&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_next_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_id</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__aenter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_pool</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__aexit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">close_pool</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_filter_option_formatter</span><span class="p">(</span>
        <span class="n">from_block</span><span class="p">:</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">],</span>
        <span class="n">to_block</span><span class="p">:</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">],</span>
        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span>
        <span class="o">|</span> <span class="n">HexStr</span>
        <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
        <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">]</span>
        <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
        <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">]],</span>
        <span class="n">topics</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts a given set of filter options into either a dictionary or list of dictionaries to be passed to the RPC</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="p">(</span><span class="n">from_block</span><span class="p">,</span> <span class="n">to_block</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">topics</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="c1"># Detects whether a set of filter options is batched</span>
            <span class="k">return</span> <span class="p">[</span>
                <span class="p">{</span><span class="s2">&quot;fromBlock&quot;</span><span class="p">:</span> <span class="n">f</span><span class="p">,</span> <span class="s2">&quot;toBlock&quot;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span> <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="n">tpc</span><span class="p">}</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">tpc</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">from_block</span><span class="p">,</span> <span class="n">to_block</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">topics</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Non-batched object return</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;fromBlock&quot;</span><span class="p">:</span> <span class="n">from_block</span><span class="p">,</span>
                <span class="s2">&quot;toBlock&quot;</span><span class="p">:</span> <span class="n">to_block</span><span class="p">,</span>
                <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="n">address</span><span class="p">,</span>
                <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="n">topics</span><span class="p">,</span>
            <span class="p">}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_block_formatter</span><span class="p">(</span>
        <span class="n">block_specifier</span><span class="p">:</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Automatically converts a DefaultBlock object to a format which can be sent via RPC</span>
<span class="sd">        DefaultBlock = int | BlockTsh | str</span>
<span class="sd">        integers are converted into their hex representation</span>
<span class="sd">        BlockTags are untouched as they are automatically converted into the appropriate strings later</span>
<span class="sd">        raw strings cannot be managed by this function and are ignored,</span>
<span class="sd">        it is expected that a provided string is either hex or the string representation of a block specifier</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">block_specifier</span><span class="p">,</span> <span class="nb">int</span>
        <span class="p">):</span>  <span class="c1"># Converts integer values from DefaultBlock to hex for parsing</span>
            <span class="n">block_specifier</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="n">block_specifier</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">block_specifier</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">block_specifier</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="c1"># Converts integers in an iterable to hex and ignores others such as Block or str data types</span>
            <span class="n">block_specifier</span> <span class="o">=</span> <span class="p">[</span>
                <span class="nb">hex</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">block_specifier</span>
            <span class="p">]</span>
        <span class="k">return</span> <span class="n">block_specifier</span>

    <span class="k">def</span> <span class="nf">_build_json</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">increment</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param method: ethereum RPC method</span>
<span class="sd">        :param params: list of parameters to use in the function call, cast to string so Hex data may be used</span>
<span class="sd">        :param increment: Boolean determining whether self._id will be advanced after the json is built</span>
<span class="sd">        :return: json string converted with json.dumps</span>
<span class="sd">        This is slightly slower than raw string construction with fstrings, but more elegant</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;jsonrpc&quot;</span><span class="p">:</span> <span class="s2">&quot;2.0&quot;</span><span class="p">,</span> <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_id</span><span class="p">}</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">increment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_next_id</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span> <span class="nf">_build_batch_json</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">param_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">increment</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param method: The ethereum JSON RPC method to be called</span>
<span class="sd">        :param param_list: A list of iterables of parameters to be appropriately formatted</span>
<span class="sd">        :param increment: If checked, this will increment the call id from this endpoint, on by default</span>
<span class="sd">        :return: Returns a stringified list of JSON objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">param_list</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">{</span><span class="s2">&quot;jsonrpc&quot;</span><span class="p">:</span> <span class="s2">&quot;2.0&quot;</span><span class="p">,</span> <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_id</span><span class="p">}</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">increment</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_next_id</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_batch_format</span><span class="p">(</span><span class="o">*</span><span class="n">param_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Automatically formats parameters for sending via build_batch_json</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">param_list</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">param_list</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">param_list</span>

<div class="viewcode-block" id="EthRPC.pool_connected"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.pool_connected">[docs]</a>    <span class="k">def</span> <span class="nf">pool_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span><span class="o">.</span><span class="n">connected</span></div>

<div class="viewcode-block" id="EthRPC.start_pool"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.start_pool">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">start_pool</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Exposes the ability to start the ERPC&#39;s socket pool before the first method call&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">ClientSession</span><span class="p">()</span></div>

<div class="viewcode-block" id="EthRPC.close_pool"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.close_pool">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">close_pool</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Closes the socket pool, this is important to not leave hanging open connections</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_send_message</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">params</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_subscription</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param method: The ethereum JSON RPC procedure to be called</span>
<span class="sd">        :param params: A list of parameters to be passed for the RPC</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :param is_subscription: A boolean defining whether a result should be decoded as a subscription</span>

<span class="sd">        Sends a message representing a call to a given method to this object&#39;s url</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch_format</span><span class="p">(</span><span class="o">*</span><span class="n">params</span><span class="p">)</span>
        <span class="c1"># json_builder is determined by whether a call is determined to be a batch or singular</span>
        <span class="n">built_msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_build_batch_json</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params</span><span class="p">)</span>
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_json</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">websocket</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Gets a new websocket if one is not supplied to the function</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Using websocket pool</span>
                <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span><span class="o">.</span><span class="n">get_socket</span><span class="p">()</span> <span class="k">as</span> <span class="n">ws</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">ws</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">built_msg</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="n">ws</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message_aio</span><span class="p">(</span><span class="n">built_msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Using a given websocket</span>
            <span class="k">await</span> <span class="n">websocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">built_msg</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="n">websocket</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">parse_results</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">is_subscription</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_send_message_aio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">built_msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">url</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_http_url</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">built_msg</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">},</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">resp</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ERPCRequestException</span><span class="p">(</span>
                    <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;Bad EthRPC aiohttp request for url </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_http_url</span><span class="si">}</span><span class="s2"> of form </span><span class="si">{</span><span class="n">built_msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">msg</span>

<div class="viewcode-block" id="EthRPC.subscribe"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.subscribe">[docs]</a>    <span class="nd">@asynccontextmanager</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">subscribe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="n">SubscriptionType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Subscription</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param method: The subscription&#39;s type, determined by a preset enum of possible types</span>
<span class="sd">        This function is decorated with an async context manager such that it can be used in an async with statement</span>

<span class="sd">        A subscription object is returned generated with a unique subscription id</span>
<span class="sd">        The subscription has a .recv() method to get the latest data returned by the ethereum endpoint</span>
<span class="sd">        for the given subscription.</span>
<span class="sd">        In the future a custom version of this function may be made to support custom subscription types.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span><span class="o">.</span><span class="n">get_socket</span><span class="p">()</span> <span class="k">as</span> <span class="n">ws</span><span class="p">:</span>
            <span class="n">subscription_id</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">subscription_id</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subscription</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">ws</span><span class="p">)</span>
                <span class="n">sub</span> <span class="o">=</span> <span class="n">Subscription</span><span class="p">(</span>
                    <span class="n">subscription_id</span><span class="o">=</span><span class="n">subscription_id</span><span class="p">,</span> <span class="n">socket</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span> <span class="n">subscription_type</span><span class="o">=</span><span class="n">method</span>
                <span class="p">)</span>
                <span class="k">yield</span> <span class="n">sub</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">subscription_id</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ERPCSubscriptionException</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Subscription of type </span><span class="si">{</span><span class="n">method</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> rejected by destination.&quot;</span>
                    <span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span> <span class="n">ws</span><span class="p">)</span></div>

    <span class="c1"># Public RPC methods</span>

<div class="viewcode-block" id="EthRPC.get_subscription"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_subscription">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_subscription</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="n">SubscriptionType</span><span class="p">,</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Supporting function for self.subscribe, opening a subscription for the provided websocket</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_subscribe&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">method</span><span class="o">.</span><span class="n">value</span><span class="p">],</span> <span class="n">websocket</span><span class="p">)</span></div>

<div class="viewcode-block" id="EthRPC.unsubscribe"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.unsubscribe">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">unsubscribe</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">subscription_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span><span class="p">,</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param subscription_id: String subscription id returned by eth_subscribe</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: The return of this function is not meant to be caught, though it does exist</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_unsubscribe&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">subscription_id</span><span class="p">],</span> <span class="n">websocket</span><span class="p">,</span> <span class="kc">True</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="EthRPC.get_block_number"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_block_number">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_block_number</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        cannot be batched</span>
<span class="sd">        :return: Integer number indicating the number of the most recently mined block</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_blockNumber&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span></div>

<div class="viewcode-block" id="EthRPC.get_transaction_count"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_transaction_count">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_transaction_count</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">],</span>
        <span class="n">block_specifier</span><span class="p">:</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">]</span> <span class="o">=</span> <span class="n">BlockTag</span><span class="o">.</span><span class="n">latest</span><span class="p">,</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the number of transactions sent from a given EOA address</span>
<span class="sd">        :param address: The address of an externally owned account</span>
<span class="sd">        :param block_specifier: A selector for a block, can be a specifier such as &#39;latest&#39; or an integer block number</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: Integer number of transactions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">block_specifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_block_formatter</span><span class="p">(</span><span class="n">block_specifier</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_getTransactionCount&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">address</span><span class="p">,</span> <span class="n">block_specifier</span><span class="p">],</span> <span class="n">websocket</span>
        <span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span>
                <span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.get_balance"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_balance">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_balance</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">contract_address</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">],</span>
        <span class="n">block_specifier</span><span class="p">:</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">]</span> <span class="o">=</span> <span class="n">BlockTag</span><span class="o">.</span><span class="n">latest</span><span class="p">,</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the balance of the account a given address points to</span>
<span class="sd">        :param contract_address: Contract address, its balance will be gotten at the block specified by quant_or_tag</span>
<span class="sd">        :param block_specifier: A selector for a block, can be a specifier such as &#39;latest&#39; or an integer block number</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: An integer balance in Wei of a given contract</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">block_specifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_block_formatter</span><span class="p">(</span><span class="n">block_specifier</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_getBalance&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">contract_address</span><span class="p">,</span> <span class="n">block_specifier</span><span class="p">],</span> <span class="n">websocket</span>
        <span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span>
                <span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.get_gas_price"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_gas_price">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_gas_price</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the current price per gas in Wei</span>
<span class="sd">        Cannot be batched</span>
<span class="sd">        :return: Integer number representing gas price in Wei</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_gasPrice&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span></div>

<div class="viewcode-block" id="EthRPC.get_block_by_number"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_block_by_number">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_block_by_number</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">block_specifier</span><span class="p">:</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">],</span>
        <span class="n">full_object</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Block</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">Block</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a Block object which represents a block&#39;s state</span>
<span class="sd">        :param block_specifier: A specifier, either int or tag, delineating the block number to get</span>
<span class="sd">        :param full_object: Boolean specifying whether the desired return uses full transactions or transaction hashes</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: A Block object representing blocks by either full transactions or transaction hashes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">block_specifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_block_formatter</span><span class="p">(</span><span class="n">block_specifier</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_getBlockByNumber&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">block_specifier</span><span class="p">,</span> <span class="n">full_object</span><span class="p">],</span> <span class="n">websocket</span>
        <span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">dict</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">Block</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">Block</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.get_block_by_hash"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_block_by_hash">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_block_by_hash</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">],</span>
        <span class="n">full_object</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Block</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">Block</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a Block object which represents a block&#39;s state</span>
<span class="sd">        :param data: Hash of a block</span>
<span class="sd">        :param full_object: Boolean specifying whether the desired return uses full transactions or transaction hashes</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: A Block object representing blocks by either full transactions or transaction hashes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_getBlockByHash&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">data</span><span class="p">,</span> <span class="n">full_object</span><span class="p">],</span> <span class="n">websocket</span>
        <span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">dict</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">Block</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">Block</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.call"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.call">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">call</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">transaction</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">Transaction</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">Transaction</span><span class="p">],</span>
        <span class="n">block_specifier</span><span class="p">:</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">]</span> <span class="o">=</span> <span class="n">BlockTag</span><span class="o">.</span><span class="n">latest</span><span class="p">,</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Executes a message call immediately without creating a transaction on the blockchain, useful for tests</span>
<span class="sd">        :param transaction: Transaction call object, represented as a dict or Transaction object</span>
<span class="sd">        :param block_specifier: A specifier, either int or tag, delineating the block number to execute the transaction</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: Hex value of the executed contract</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">block_specifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_block_formatter</span><span class="p">(</span><span class="n">block_specifier</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_call&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">transaction</span><span class="p">,</span> <span class="n">block_specifier</span><span class="p">],</span> <span class="n">websocket</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="EthRPC.get_transaction_receipt"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_transaction_receipt">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_transaction_receipt</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">tx_hash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">],</span>
        <span class="n">retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Receipt</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">Receipt</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the receipt of a transaction given its hash, the definition of a receipt can be seen in dclasses.py</span>

<span class="sd">        :param tx_hash: Hash of the transaction from which the receipt should be derived</span>
<span class="sd">        :param retries: (Optional) The maximum number of retries to attempt until receipt has been generated</span>
<span class="sd">        :param websocket: (Optional) external websocket for calls to this function</span>
<span class="sd">        :return: Transaction receipt object or list of transaction receipts</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_getTransactionReceipt&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">tx_hash</span><span class="p">],</span> <span class="n">websocket</span>
        <span class="p">)</span>

        <span class="c1"># Retry getting transaction receipt until either it is found or retries are exhausted</span>
        <span class="k">while</span> <span class="n">msg</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">retries</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
                <span class="s2">&quot;eth_getTransactionReceipt&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">tx_hash</span><span class="p">],</span> <span class="n">websocket</span>
            <span class="p">)</span>
            <span class="n">retries</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">dict</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">Receipt</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">Receipt</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.send_raw_transaction"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.send_raw_transaction">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">send_raw_transaction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">raw_transaction</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the receipt of a transaction by transaction hash</span>
<span class="sd">        :param raw_transaction: The hash of a transaction</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :type: 32 Byte Hex</span>
<span class="sd">        :return: Transaction receipt object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_sendRawTransaction&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">raw_transaction</span><span class="p">],</span> <span class="n">websocket</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="EthRPC.send_transaction"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.send_transaction">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">send_transaction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">transaction</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new message call transaction or contract creation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_sendTransaction&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">transaction</span><span class="p">],</span> <span class="n">websocket</span><span class="p">)</span></div>

<div class="viewcode-block" id="EthRPC.get_protocol_version"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_protocol_version">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_protocol_version</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_protocolVersion&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span></div>

<div class="viewcode-block" id="EthRPC.get_sync_status"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_sync_status">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_sync_status</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">Sync</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_syncing&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">bool</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Sync</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="EthRPC.get_coinbase"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_coinbase">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_coinbase</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_coinbase&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">HexStr</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="k">if</span> <span class="n">msg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="EthRPC.get_chain_id"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_chain_id">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_chain_id</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_chainId&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span></div>

<div class="viewcode-block" id="EthRPC.is_mining"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.is_mining">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">is_mining</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_mining&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">websocket</span><span class="p">)</span></div>

<div class="viewcode-block" id="EthRPC.get_hashrate"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_hashrate">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_hashrate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_hashrate&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span></div>

<div class="viewcode-block" id="EthRPC.get_accounts"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_accounts">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_accounts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of addresses owned by client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_accounts&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">HexStr</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span> <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.get_transaction_count_by_hash"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_transaction_count_by_hash">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_transaction_count_by_hash</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the number of transactions in a block from a block matching the given block hash.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_getBlockTransactionCountByHash&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">data</span><span class="p">],</span> <span class="n">websocket</span>
        <span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span>
                <span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.get_transaction_count_by_number"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_transaction_count_by_number">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_transaction_count_by_number</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">block_specifier</span><span class="p">:</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the number of transactions in a block matching the given block number.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">block_specifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_block_formatter</span><span class="p">(</span><span class="n">block_specifier</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_getBlockTransactionCountByNumber&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">block_specifier</span><span class="p">],</span> <span class="n">websocket</span>
        <span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span>
                <span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.get_uncle_count_by_hash"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_uncle_count_by_hash">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_uncle_count_by_hash</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the number of uncles in a block from a block matching the given block hash.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_getUncleCountByBlockHash&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">data</span><span class="p">],</span> <span class="n">websocket</span>
        <span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span>
                <span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.get_uncle_count_by_number"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_uncle_count_by_number">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_uncle_count_by_number</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">block_specifier</span><span class="p">:</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the number of uncles in a block from a block matching the given block number.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">block_specifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_block_formatter</span><span class="p">(</span><span class="n">block_specifier</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_getUncleCountByBlockNumber&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">block_specifier</span><span class="p">],</span> <span class="n">websocket</span>
        <span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span>
                <span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.get_code"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_code">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_code</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">],</span>
        <span class="n">block_specifier</span><span class="p">:</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns code at a given address for a given block number.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">block_specifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_block_formatter</span><span class="p">(</span><span class="n">block_specifier</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_getCode&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">data</span><span class="p">,</span> <span class="n">block_specifier</span><span class="p">],</span> <span class="n">websocket</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="EthRPC.sign"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.sign">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">sign</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">],</span>
        <span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the ethereum specific signature.</span>

<span class="sd">        :param data: 20 byte address(es) to sign with</span>
<span class="sd">        :param message: N byte message(s) to be signed</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: Hex string(s) containing signature(s) for given data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_sign&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">data</span><span class="p">,</span> <span class="n">message</span><span class="p">],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">HexStr</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">case</span> <span class="nb">list</span><span class="p">():</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">HexStr</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.sign_transaction"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.sign_transaction">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">sign_transaction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">tx</span><span class="p">:</span> <span class="n">TransactionFull</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">TransactionFull</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Signs a transaction that can be submitted to the network at a later time using with eth_sendRawTransaction.</span>

<span class="sd">        :param tx: Transaction object(s) or dict(s) defining transaction parameters to be signed</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: Hex string(s) containing result(s) of signed transaction(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_signTransaction&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">tx</span><span class="p">],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">HexStr</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">case</span> <span class="nb">list</span><span class="p">():</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">HexStr</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.estimate_gas"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.estimate_gas">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">estimate_gas</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">transaction</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
        <span class="n">block_specifier</span><span class="p">:</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">]</span> <span class="o">=</span> <span class="n">BlockTag</span><span class="o">.</span><span class="n">latest</span><span class="p">,</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and returns an estimate of how much gas is necessary to allow the transaction to complete.</span>
<span class="sd">        The transaction will not be added to the blockchain.</span>
<span class="sd">        Note that the estimate may be significantly more than the amount of gas actually used by the transaction,</span>
<span class="sd">        for a variety of reasons including EVM mechanics and node performance.</span>

<span class="sd">        Uses the same parameters as eth_call, see above</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">block_specifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_block_formatter</span><span class="p">(</span><span class="n">block_specifier</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_estimateGas&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">transaction</span><span class="p">,</span> <span class="n">block_specifier</span><span class="p">],</span> <span class="n">websocket</span>
        <span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span>
                <span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.get_transaction_by_hash"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_transaction_by_hash">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_transaction_by_hash</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TransactionFull</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">TransactionFull</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the information about a transaction requested by transaction hash.</span>

<span class="sd">        :param data: A hash (or list thereof) delineating the transaction(s) to get</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: A TransactionFull object (or list thereof) containing information about the selected transaction(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_getTransactionByHash&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">data</span><span class="p">],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">dict</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">TransactionFull</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="n">TransactionFull</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span>
                <span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.get_transaction_by_block_hash_and_index"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_transaction_by_block_hash_and_index">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_transaction_by_block_hash_and_index</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">],</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TransactionFull</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">TransactionFull</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns information about a transaction by block hash and transaction index position.</span>

<span class="sd">        :param data: A hash (or list thereof) delineating the block number(s) to get</span>
<span class="sd">        :param index: The index position(s) of the transaction(s) for the given block</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: A TransactionFull object (or list thereof) containing information about the selected transaction(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_getTransactionByBlockHashAndIndex&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="p">],</span> <span class="n">websocket</span>
        <span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">dict</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">TransactionFull</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="n">TransactionFull</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span>
                <span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.get_transaction_by_block_number_and_index"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_transaction_by_block_number_and_index">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_transaction_by_block_number_and_index</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">block_specifier</span><span class="p">:</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">],</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TransactionFull</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">TransactionFull</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns information about a transaction by block number and transaction index position.</span>

<span class="sd">        :param block_specifier: A specifier, either int or tag, (or list thereof) delineating the block number(s) to get</span>
<span class="sd">        :param index: The index position(s) of the transaction for the given block(s)</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: A TransactionFull object (or list thereof) containing information about the selected transaction(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">block_specifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_block_formatter</span><span class="p">(</span><span class="n">block_specifier</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_getTransactionByBlockNumberAndIndex&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="n">block_specifier</span><span class="p">,</span> <span class="n">index</span><span class="p">],</span>
            <span class="n">websocket</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">dict</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">TransactionFull</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="n">TransactionFull</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span>
                <span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.get_uncle_by_block_hash_and_index"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_uncle_by_block_hash_and_index">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_uncle_by_block_hash_and_index</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">],</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Block</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">Block</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns information about an uncle of a block by hash and uncle index position.</span>

<span class="sd">        :param data: A hash delineating the block number to get</span>
<span class="sd">        :param index: The index position(s) of the uncle(s) for the given block(s)</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: A Block object (or list thereof) containing information about the selected uncle(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_getUncleByBlockHashAndIndex&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="p">],</span> <span class="n">websocket</span>
        <span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">dict</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">Block</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">Block</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.get_uncle_by_block_number_and_index"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_uncle_by_block_number_and_index">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_uncle_by_block_number_and_index</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">block_specifier</span><span class="p">:</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">],</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Block</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">Block</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns information about an uncle of a block by number and uncle index position.</span>

<span class="sd">        :param block_specifier: A specifier, either int or tag, (or list thereof) delineating the block number(s) to get</span>
<span class="sd">        :param index: The index position(s) of the uncle(s) for the given block(s)</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: A Block object (or list thereof) containing information about the selected uncle(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">block_specifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_block_formatter</span><span class="p">(</span><span class="n">block_specifier</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span>
            <span class="s2">&quot;eth_getUncleByBlockNumberAndIndex&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">block_specifier</span><span class="p">,</span> <span class="n">index</span><span class="p">],</span> <span class="n">websocket</span>
        <span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">dict</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">Block</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">Block</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">infer_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.new_filter"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.new_filter">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">new_filter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">from_block</span><span class="p">:</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">],</span>
        <span class="n">to_block</span><span class="p">:</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">],</span>
        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span>
        <span class="o">|</span> <span class="n">HexStr</span>
        <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
        <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">]</span>
        <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
        <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">]],</span>
        <span class="n">topics</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">]],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a filter object based on filter parameters to notify when the state changes.</span>
<span class="sd">        To check if the state has changed use EthRPC.get_filter_changes()</span>

<span class="sd">        :param from_block: Block from which the filter is active</span>
<span class="sd">        :param to_block: Block to which the filter is active</span>
<span class="sd">        :param address: Contract address or list of addresses from which logs should originate</span>
<span class="sd">        :param topics: Array of 32 byte data topics, topics are order dependent</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: Returns an integer filter ID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="n">from_block</span><span class="p">,</span>
            <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="n">to_block</span><span class="p">,</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="n">address</span><span class="p">,</span>
            <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="n">topics</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_newFilter&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">param</span><span class="p">],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span>
                <span class="p">]</span></div>

<div class="viewcode-block" id="EthRPC.new_block_filter"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.new_block_filter">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">new_block_filter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a filter in the endpoint to notify when a new block arrives.</span>
<span class="sd">        To check if the state has changed use EthRPC.get_filter_changes()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_newBlockFilter&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span></div>

<div class="viewcode-block" id="EthRPC.new_pending_transaction_filter"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.new_pending_transaction_filter">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">new_pending_transaction_filter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a filter in the endpoint to notify when new pending transactions arrive.</span>
<span class="sd">        To check if the state has changed use EthRPC.get_filter_changes()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_newPendingTransactionFilter&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span></div>

<div class="viewcode-block" id="EthRPC.uninstall_filter"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.uninstall_filter">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">uninstall_filter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filter_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Uninstalls a filter with a given name.</span>
<span class="sd">        Should always be called when a filter is no longer needed.</span>

<span class="sd">        :param filter_id: A filter ID generated by creating a filter previously</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: bool or list of bools indicating the success or failure of each filter uninstallation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_block_formatter</span><span class="p">(</span><span class="n">filter_id</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_uninstallFilter&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">filter_id</span><span class="p">],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="EthRPC.get_filter_changes"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_filter_changes">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_filter_changes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filter_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of all logs matching filter with given id.</span>
<span class="sd">        Used with other filter creation methods taking in their filter numbers as input.</span>

<span class="sd">        :param filter_id: A filter ID generated by creating a filter previously</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: list of Hex strings (or list of lists) indicating changes made since filter was last checked</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_block_formatter</span><span class="p">(</span><span class="n">filter_id</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_getFilterChanges&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">filter_id</span><span class="p">],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="n">l</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">l</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[[</span><span class="n">HexStr</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">]</span>
            <span class="k">case</span> <span class="nb">list</span><span class="p">():</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">HexStr</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">]</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ERPCInvalidReturnException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Unexpected return of form </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2"> in get_filter_changes&quot;</span>
                <span class="p">)</span></div>

<div class="viewcode-block" id="EthRPC.get_filter_logs"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_filter_logs">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_filter_logs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filter_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Log</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Log</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of all logs matching the filter with the provided ID</span>

<span class="sd">        :param filter_id: A filter ID generated by creating a filter previously</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: list or list of lists of Log objects indicating the new logs created since the filter was last checked</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_block_formatter</span><span class="p">(</span><span class="n">filter_id</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_getFilterLogs&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">filter_id</span><span class="p">],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="n">l</span> <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">l</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[[</span><span class="n">Log</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">]</span>
            <span class="k">case</span> <span class="n">li</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">li</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">li</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">Log</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">]</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ERPCInvalidReturnException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Unexpected return of form </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2"> in get_filter_changes&quot;</span>
                <span class="p">)</span></div>

<div class="viewcode-block" id="EthRPC.get_logs"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_logs">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_logs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">from_block</span><span class="p">:</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">],</span>
        <span class="n">to_block</span><span class="p">:</span> <span class="n">DefaultBlock</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefaultBlock</span><span class="p">],</span>
        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span>
        <span class="o">|</span> <span class="n">HexStr</span>
        <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
        <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">]</span>
        <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
        <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">]],</span>
        <span class="n">topics</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">]],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Log</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Log</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param from_block: Block from which the filter is active</span>
<span class="sd">        :param to_block: Block to which the filter is active</span>
<span class="sd">        :param address: Contract address or list of addresses from which logs should originate</span>
<span class="sd">        :param topics: Array of 32 byte data topics, topics are order dependent</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: Returns a list of log objects or nothing if no changes have occurred since last poll</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="n">from_block</span><span class="p">,</span>
            <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="n">to_block</span><span class="p">,</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="n">address</span><span class="p">,</span>
            <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="n">topics</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;eth_getLogs&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">param</span><span class="p">],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span> <span class="n">l</span> <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">l</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[[</span><span class="n">Log</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">]</span>
            <span class="k">case</span> <span class="n">li</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">li</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">li</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">Log</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">]</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ERPCInvalidReturnException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Unexpected return of form </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2"> in get_filter_changes&quot;</span>
                <span class="p">)</span></div>

    <span class="c1"># Web3 functions</span>

<div class="viewcode-block" id="EthRPC.get_client_version"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_client_version">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_client_version</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the current client version</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;web3_clientVersion&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">websocket</span><span class="p">)</span></div>

<div class="viewcode-block" id="EthRPC.sha3"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.sha3">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">sha3</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns Keccak-256 of the given data</span>

<span class="sd">        :param data: A string of data for keccak conversion</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;web3_sha3&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">data</span><span class="p">],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">HexStr</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">case</span> <span class="nb">list</span><span class="p">():</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">HexStr</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">]</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ERPCInvalidReturnException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Unexpected return of form </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2"> in sha3&quot;</span>
                <span class="p">)</span></div>

    <span class="c1"># Net functions</span>

<div class="viewcode-block" id="EthRPC.get_net_version"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_net_version">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_net_version</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the network version ID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;net_version&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="EthRPC.get_net_listening"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_net_listening">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_net_listening</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns whether a client is actively listening for network connections</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;net_listening&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">websocket</span><span class="p">)</span></div>

<div class="viewcode-block" id="EthRPC.get_net_peer_count"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.get_net_peer_count">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_net_peer_count</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the number of peers connected to the client</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="s2">&quot;net_peerCount&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">websocket</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span></div>

    <span class="c1"># Generic sending</span>

<div class="viewcode-block" id="EthRPC.send_raw"><a class="viewcode-back" href="../../pythereum.html#pythereum.rpc.EthRPC.send_raw">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">send_raw</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">method_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">HexStr</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">HexStr</span><span class="p">],</span>
        <span class="n">params</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span>
        <span class="n">websocket</span><span class="p">:</span> <span class="n">websockets</span><span class="o">.</span><span class="n">WebSocketClientProtocol</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sends a custom method name method_name to the endpoint&#39;s url with the given parameter list</span>

<span class="sd">        :param method_name: A string indicating the method name to be called with the given parameters</span>
<span class="sd">        :param params: A list of parameters to be sent for the function call</span>
<span class="sd">        :param websocket: An optional external websocket for calls to this function</span>
<span class="sd">        :return: Returns the result of the given transaction,</span>
<span class="sd">        if the function does not exist for the given params an error will be raised</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_message</span><span class="p">(</span><span class="n">method_name</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">websocket</span><span class="p">)</span></div></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Pythereum</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Gabriel Donnan.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>